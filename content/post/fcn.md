---
title: "全卷积语义分割网络 —— FCN"
date: 2018-09-04T16:36:58+08:00
draft: false
keywords:
- 深度学习
- 语义分割
- deep learning
- semantic segmentation
categories:
- notes
tags:
- 深度学习
- 图像分割
disqusIdentifier: 
comments: true
thumbnailImage: https://s1.ax1x.com/2018/09/04/iSo876.png
coverMeta: out
metaAlignment: center
markup: mmark
---

CVPR'2015 的 FCN 可以说是这一波深度学习浪潮中针对图像语义分割任务的开山之作。这份工作首次引入了全卷积网络的概念，并在 VOC 等数据集上都取得了不错的效果。

<!--more-->


# 简介

---

在 2015 年之前，图像分类任务比较火爆。相比之下，图像语义分割任务的发展程度还远远不及前者。FCN 在这一年应运而生，为后人在图像分割领域的研究打下了夯实的基础。

FCN 的主要思想就是将原本图像分类网络中的那些全连接层替换成为卷积层，使得网络中所有层均为卷积/池化层，最终也将输出一张与输入图像大小相同的分割结果。


# 技术细节

---

<center>![fcn-arch](https://s1.ax1x.com/2018/09/04/iSTl8g.png)</center>

FCN 的大致网络结构如上图，图中省略了网络中的卷积层（使用的 base model 不同，卷积层的设计也不尽相同）。

在经过若干次池化操作后，特征图将会变得非常小。虽然深层特征图的感受野较大，但也存在提取特征不够细致的缺点。如果只使用最后一个池化层输出的特征图上采样后的图像作为分割结果，则会导致分割结果比较粗糙。

作者的解决办法是将最后三个池化层的输出结果 combine 在一起。具体操作如上图所示，将粗糙的特征图做二倍上采样后与其上层特征图求和，得到精细一些的结果；同样的操作再执行一次，即可得到更精细的结果。

精细化操作将图像由粗糙到精细的特征结合在一起，得到了更好的效果。下图展示了三种不同精细程度的分割结果对比，明显可以看出结合了多种特征的分割结果与 ground truth 更为接近。

<center>![fcn-coarse-to-fine](https://s1.ax1x.com/2018/09/04/iS7pss.png)</center>

作者在论文中提到了图像上采样方法，引出了 shift-and-stitch 以及转置卷积等技术。由于这些不是文章的核心部分，所以不再赘述。


# 总结

---

这篇论文属于开创性工作。虽然实验结果相对后人的众多工作不算好，但全卷积、跳跃连接等技术被后面的研究者大量使用，也算是为图像语义分割领域做出了比较大的贡献。

最后放一张 FCN 的实验结果，包括与当时比较流行的方法 SDS（ECCV'2014）的比较。

<center>![fcn-result](https://s1.ax1x.com/2018/09/04/iS7fwq.png)</center>